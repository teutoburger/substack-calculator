<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Substack Fee Calculator | The Creator Shift</title>
    <meta name="description" content="Berechne realistisch, wie viele zahlende Abonnent*innen du für dein Umsatzziel brauchst – oder was du mit deiner aktuellen Basis verdienen kannst.">
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX transformation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background-color: #fafafa;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;

        function SubstackFeeCalculator() {
            // Calculation mode
            const [mode, setMode] = useState('revenueToSubs');
            
            // Basic inputs
            const [targetRevenue, setTargetRevenue] = useState(1000);
            const [monthlyPrice, setMonthlyPrice] = useState(5);
            const [subscriberCount, setSubscriberCount] = useState(100);
            
            // Expert controls
            const [showExpert, setShowExpert] = useState(false);
            const [conversionRate, setConversionRate] = useState(3);
            const [monthlyShare, setMonthlyShare] = useState(30);
            const [yearlyShare, setYearlyShare] = useState(69);
            const [foundingShare, setFoundingShare] = useState(1);
            const [yearlyMultiplier, setYearlyMultiplier] = useState(10);
            const [foundingMultiplier, setFoundingMultiplier] = useState(25);
            
            // Results
            const [results, setResults] = useState(null);

            // Default values for reset
            const defaults = {
                conversionRate: 3,
                monthlyShare: 30,
                yearlyShare: 69,
                foundingShare: 1,
                yearlyMultiplier: 10,
                foundingMultiplier: 25
            };

            // Reset expert controls to defaults
            const resetExpertControls = () => {
                setConversionRate(defaults.conversionRate);
                setMonthlyShare(defaults.monthlyShare);
                setYearlyShare(defaults.yearlyShare);
                setFoundingShare(defaults.foundingShare);
                setYearlyMultiplier(defaults.yearlyMultiplier);
                setFoundingMultiplier(defaults.foundingMultiplier);
            };

            // Check if percentages sum to 100
            const percentageSum = monthlyShare + yearlyShare + foundingShare;
            const percentageWarning = percentageSum !== 100;

            // Calculate weighted months per paid subscriber
            const calculateWeightedMonths = () => {
                const monthly = (monthlyShare / 100) * 12;
                const yearly = (yearlyShare / 100) * yearlyMultiplier;
                const founding = (foundingShare / 100) * foundingMultiplier;
                return monthly + yearly + founding;
            };

            // Platform fees: 10% Substack + 3% Stripe = 13%
            const platformFeeRate = 0.13;

            useEffect(() => {
                const weightedMonths = calculateWeightedMonths();
                const revenuePerPaidSub = monthlyPrice * weightedMonths;
                const netFactor = 1 - platformFeeRate;

                if (mode === 'revenueToSubs') {
                    // From net revenue target to required subscribers
                    const grossRevenue = targetRevenue / netFactor;
                    const paidSubsNeeded = grossRevenue / revenuePerPaidSub;
                    const totalSubsNeeded = paidSubsNeeded / (conversionRate / 100);
                    const fees = grossRevenue - targetRevenue;

                    setResults({
                        mode: 'revenueToSubs',
                        targetNetRevenue: targetRevenue,
                        grossRevenue: grossRevenue,
                        fees: fees,
                        paidSubscribers: Math.ceil(paidSubsNeeded),
                        totalSubscribers: Math.ceil(totalSubsNeeded),
                        revenuePerPaidSub: revenuePerPaidSub,
                        weightedMonths: weightedMonths
                    });
                } else {
                    // From subscriber count to projected revenue
                    const paidSubs = subscriberCount * (conversionRate / 100);
                    const grossRevenue = paidSubs * revenuePerPaidSub;
                    const netRevenue = grossRevenue * netFactor;
                    const fees = grossRevenue - netRevenue;

                    setResults({
                        mode: 'subsToRevenue',
                        totalSubscribers: subscriberCount,
                        paidSubscribers: Math.round(paidSubs),
                        grossRevenue: grossRevenue,
                        netRevenue: netRevenue,
                        fees: fees,
                        revenuePerPaidSub: revenuePerPaidSub,
                        weightedMonths: weightedMonths
                    });
                }
            }, [mode, targetRevenue, monthlyPrice, subscriberCount, conversionRate, 
                monthlyShare, yearlyShare, foundingShare, yearlyMultiplier, foundingMultiplier]);

            const formatCurrency = (value) => {
                return new Intl.NumberFormat('de-DE', { 
                    style: 'currency', 
                    currency: 'EUR',
                    minimumFractionDigits: 0,
                    maximumFractionDigits: 0
                }).format(value);
            };

            const formatNumber = (value) => {
                return new Intl.NumberFormat('de-DE').format(value);
            };

            return (
                <div className="max-w-2xl mx-auto p-6">
                    <div className="bg-white rounded-xl shadow-lg p-6 mb-6">
                        <h1 className="text-2xl font-bold text-gray-800 mb-2">
                            Substack Fee Calculator
                        </h1>
                        <p className="text-gray-600 mb-6">
                            Realistische Zahlen statt Wunschdenken: Was brauchst du wirklich für dein Umsatzziel?
                        </p>

                        {/* Mode Toggle */}
                        <div className="flex gap-2 mb-6 p-1 bg-gray-100 rounded-lg">
                            <button
                                onClick={() => setMode('revenueToSubs')}
                                className={`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-all ${
                                    mode === 'revenueToSubs' 
                                        ? 'bg-orange-500 text-white shadow' 
                                        : 'text-gray-600 hover:bg-gray-200'
                                }`}
                            >
                                Umsatzziel → Abos
                            </button>
                            <button
                                onClick={() => setMode('subsToRevenue')}
                                className={`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-all ${
                                    mode === 'subsToRevenue' 
                                        ? 'bg-orange-500 text-white shadow' 
                                        : 'text-gray-600 hover:bg-gray-200'
                                }`}
                            >
                                Abos → Umsatz
                            </button>
                        </div>

                        {/* Basic Inputs */}
                        <div className="space-y-4 mb-6">
                            {mode === 'revenueToSubs' ? (
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-1">
                                        Netto-Umsatzziel pro Jahr (nach Gebühren)
                                    </label>
                                    <div className="relative">
                                        <input
                                            type="number"
                                            value={targetRevenue}
                                            onChange={(e) => setTargetRevenue(Number(e.target.value))}
                                            className="w-full p-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                                            min="0"
                                            step="100"
                                        />
                                        <span className="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500">€</span>
                                    </div>
                                </div>
                            ) : (
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-1">
                                        Anzahl Gesamt-Abonnent*innen (gratis + paid)
                                    </label>
                                    <input
                                        type="number"
                                        value={subscriberCount}
                                        onChange={(e) => setSubscriberCount(Number(e.target.value))}
                                        className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                                        min="0"
                                        step="100"
                                    />
                                </div>
                            )}

                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-1">
                                    Monatlicher Abo-Preis
                                </label>
                                <div className="relative">
                                    <input
                                        type="number"
                                        value={monthlyPrice}
                                        onChange={(e) => setMonthlyPrice(Number(e.target.value))}
                                        className="w-full p-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                                        min="1"
                                        step="1"
                                    />
                                    <span className="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500">€</span>
                                </div>
                                <p className="text-xs text-gray-500 mt-1">
                                    Jahresabo: {formatCurrency(monthlyPrice * yearlyMultiplier)} · 
                                    Founding Member: {formatCurrency(monthlyPrice * foundingMultiplier)}
                                </p>
                            </div>
                        </div>

                        {/* Expert Controls Toggle */}
                        <button
                            onClick={() => setShowExpert(!showExpert)}
                            className="flex items-center gap-2 text-sm text-gray-600 hover:text-orange-600 mb-4"
                        >
                            <span className={`transform transition-transform ${showExpert ? 'rotate-90' : ''}`}>
                                ▶
                            </span>
                            Experten-Einstellungen
                        </button>

                        {/* Expert Controls */}
                        {showExpert && (
                            <div className="bg-gray-50 rounded-lg p-4 mb-6 space-y-4">
                                <div className="flex justify-between items-center mb-2">
                                    <h3 className="text-sm font-medium text-gray-700">Parameter anpassen</h3>
                                    <button
                                        onClick={resetExpertControls}
                                        className="text-xs px-3 py-1 bg-orange-100 text-orange-700 rounded hover:bg-orange-200 transition-colors"
                                    >
                                        Zurücksetzen
                                    </button>
                                </div>
                                
                                <div>
                                    <label className="block text-sm text-gray-600 mb-1">
                                        Conversion Rate (Gratis → Paid): {conversionRate}%
                                        <span className="ml-1 text-gray-400 cursor-help" title="Typisch: 1-5% bei neuen Substacks, bis 10% bei etablierten Nischen-Publikationen">ⓘ</span>
                                    </label>
                                    <input
                                        type="range"
                                        value={conversionRate}
                                        onChange={(e) => setConversionRate(Number(e.target.value))}
                                        className="w-full accent-orange-500"
                                        min="1"
                                        max="10"
                                        step="0.5"
                                    />
                                    <div className="flex justify-between text-xs text-gray-400">
                                        <span>1%</span>
                                        <span>10%</span>
                                    </div>
                                </div>

                                <div className="border-t border-gray-200 pt-4">
                                    <div className="flex justify-between items-center mb-2">
                                        <label className="block text-sm text-gray-600">
                                            Abo-Verteilung
                                            <span className="ml-1 text-gray-400 cursor-help" title="Wie verteilen sich deine zahlenden Abos auf die verschiedenen Laufzeiten?">ⓘ</span>
                                        </label>
                                        {percentageWarning && (
                                            <span className="text-xs text-amber-600 bg-amber-50 px-2 py-1 rounded">
                                                Summe: {percentageSum}% (≠ 100%)
                                            </span>
                                        )}
                                    </div>
                                    
                                    <div className="grid grid-cols-3 gap-3">
                                        <div>
                                            <label className="block text-xs text-gray-500 mb-1">Monatlich</label>
                                            <div className="relative">
                                                <input
                                                    type="number"
                                                    value={monthlyShare}
                                                    onChange={(e) => setMonthlyShare(Number(e.target.value))}
                                                    className="w-full p-2 pr-6 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-orange-500"
                                                    min="0"
                                                    max="100"
                                                />
                                                <span className="absolute right-2 top-1/2 -translate-y-1/2 text-xs text-gray-400">%</span>
                                            </div>
                                        </div>
                                        <div>
                                            <label className="block text-xs text-gray-500 mb-1">Jährlich</label>
                                            <div className="relative">
                                                <input
                                                    type="number"
                                                    value={yearlyShare}
                                                    onChange={(e) => setYearlyShare(Number(e.target.value))}
                                                    className="w-full p-2 pr-6 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-orange-500"
                                                    min="0"
                                                    max="100"
                                                />
                                                <span className="absolute right-2 top-1/2 -translate-y-1/2 text-xs text-gray-400">%</span>
                                            </div>
                                        </div>
                                        <div>
                                            <label className="block text-xs text-gray-500 mb-1">Founding</label>
                                            <div className="relative">
                                                <input
                                                    type="number"
                                                    value={foundingShare}
                                                    onChange={(e) => setFoundingShare(Number(e.target.value))}
                                                    className="w-full p-2 pr-6 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-orange-500"
                                                    min="0"
                                                    max="100"
                                                />
                                                <span className="absolute right-2 top-1/2 -translate-y-1/2 text-xs text-gray-400">%</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div className="border-t border-gray-200 pt-4">
                                    <label className="block text-sm text-gray-600 mb-2">
                                        Preis-Multiplikatoren (vs. Monatspreis)
                                        <span className="ml-1 text-gray-400 cursor-help" title="Substack-Standard: Jahresabo = 10× Monatspreis, Founding = 25× Monatspreis">ⓘ</span>
                                    </label>
                                    <div className="grid grid-cols-2 gap-3">
                                        <div>
                                            <label className="block text-xs text-gray-500 mb-1">Jahresabo</label>
                                            <div className="relative">
                                                <input
                                                    type="number"
                                                    value={yearlyMultiplier}
                                                    onChange={(e) => setYearlyMultiplier(Number(e.target.value))}
                                                    className="w-full p-2 pr-6 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-orange-500"
                                                    min="1"
                                                    max="12"
                                                />
                                                <span className="absolute right-2 top-1/2 -translate-y-1/2 text-xs text-gray-400">×</span>
                                            </div>
                                        </div>
                                        <div>
                                            <label className="block text-xs text-gray-500 mb-1">Founding Member</label>
                                            <div className="relative">
                                                <input
                                                    type="number"
                                                    value={foundingMultiplier}
                                                    onChange={(e) => setFoundingMultiplier(Number(e.target.value))}
                                                    className="w-full p-2 pr-6 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-orange-500"
                                                    min="1"
                                                    max="50"
                                                />
                                                <span className="absolute right-2 top-1/2 -translate-y-1/2 text-xs text-gray-400">×</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* Results */}
                        {results && (
                            <div className="bg-gradient-to-br from-orange-50 to-amber-50 rounded-lg p-6">
                                <h2 className="text-lg font-semibold text-gray-800 mb-4">Ergebnis</h2>
                                
                                {results.mode === 'revenueToSubs' ? (
                                    <div className="space-y-3">
                                        <div className="flex justify-between items-center py-2 border-b border-orange-200">
                                            <span className="text-gray-600">Benötigte Paid-Abos</span>
                                            <span className="text-2xl font-bold text-orange-600">
                                                {formatNumber(results.paidSubscribers)}
                                            </span>
                                        </div>
                                        <div className="flex justify-between items-center py-2 border-b border-orange-200">
                                            <span className="text-gray-600">Benötigte Gesamt-Abos</span>
                                            <span className="text-xl font-semibold text-gray-800">
                                                {formatNumber(results.totalSubscribers)}
                                            </span>
                                        </div>
                                        <div className="flex justify-between items-center py-2 border-b border-orange-200">
                                            <span className="text-gray-600">Brutto-Umsatz</span>
                                            <span className="text-gray-800">{formatCurrency(results.grossRevenue)}</span>
                                        </div>
                                        <div className="flex justify-between items-center py-2">
                                            <span className="text-gray-600">Plattform-Gebühren (13%)</span>
                                            <span className="text-red-600">−{formatCurrency(results.fees)}</span>
                                        </div>
                                    </div>
                                ) : (
                                    <div className="space-y-3">
                                        <div className="flex justify-between items-center py-2 border-b border-orange-200">
                                            <span className="text-gray-600">Netto-Umsatz pro Jahr</span>
                                            <span className="text-2xl font-bold text-orange-600">
                                                {formatCurrency(results.netRevenue)}
                                            </span>
                                        </div>
                                        <div className="flex justify-between items-center py-2 border-b border-orange-200">
                                            <span className="text-gray-600">Erwartete Paid-Abos</span>
                                            <span className="text-xl font-semibold text-gray-800">
                                                {formatNumber(results.paidSubscribers)}
                                            </span>
                                        </div>
                                        <div className="flex justify-between items-center py-2 border-b border-orange-200">
                                            <span className="text-gray-600">Brutto-Umsatz</span>
                                            <span className="text-gray-800">{formatCurrency(results.grossRevenue)}</span>
                                        </div>
                                        <div className="flex justify-between items-center py-2">
                                            <span className="text-gray-600">Plattform-Gebühren (13%)</span>
                                            <span className="text-red-600">−{formatCurrency(results.fees)}</span>
                                        </div>
                                    </div>
                                )}

                                <div className="mt-4 pt-4 border-t border-orange-200">
                                    <p className="text-xs text-gray-500">
                                        Berechnung basiert auf: {conversionRate}% Conversion Rate · 
                                        {results.weightedMonths.toFixed(2)} gewichtete Monate pro Paid-Abo · 
                                        {formatCurrency(results.revenuePerPaidSub)} Umsatz pro Paid-Abo/Jahr
                                    </p>
                                </div>
                            </div>
                        )}
                    </div>

                    {/* Footer */}
                    <div className="text-center text-sm text-gray-500">
                        <p>
                            Ein Tool von{' '}
                            <a 
                                href="https://thcrtrshft.substack.com" 
                                target="_blank" 
                                rel="noopener noreferrer"
                                className="text-orange-600 hover:underline"
                            >
                                The Creator Shift
                            </a>
                        </p>
                        <p className="mt-1">
                            Gebührenstruktur: 10% Substack + 3% Stripe = 13% gesamt
                        </p>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<SubstackFeeCalculator />);
    </script>
</body>
</html>
